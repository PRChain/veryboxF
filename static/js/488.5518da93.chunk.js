"use strict";(self.webpackChunkverybox_tools=self.webpackChunkverybox_tools||[]).push([[488],{62446:function(e,t,a){a.d(t,{Z:function(){return c}});a(47313);var n=a(9381),s=a(24240),r=a(80504),i=a(36368),l=a(59017),d=a(46417);function c(){const{t:e}=(0,s.$)(),t=(0,n.v9)((e=>e.blockchain)),a=(0,n.I0)();return(0,d.jsx)(i.Z,{fullWidth:!0,title:e("gasLimit.title"),id:"gasLimit",sx:{mb:0,mt:0,width:"20ch"},label:e("gasLimit.label"),variant:"outlined",size:"small",type:"number",value:t.gasLimit,onChange:e=>{a((0,r.OQ)({gasLimit:parseInt(e.target.value)}))},InputProps:{endAdornment:(0,d.jsx)(l.Z,{position:"end",children:"Gwei"})}})}},53488:function(e,t,a){a.r(t),a.d(t,{default:function(){return E}});var n=a(47313),s=a(24240),r=a(9381),i=a(82937),l=a(18104),d=a(83719),c=a(36368),o=a(605),m=a(11626),u=a(62463),h=a(83077),x=a(43394),p=a(66356),g=a(68737),P=a(78611),j=a(17201),Z=a(35540),y=a(25319),v=a(10383),f=a(91294),b=a(74897),F=a(81962),k=a(35192),A=a(62111),w=a(46417);function C(e){const{t:t}=(0,s.$)(),[a,r]=((0,A.Z)(),(0,n.useState)(""));return n.useEffect((()=>{r(e.value)}),[e]),(0,w.jsxs)(i.ZP,{container:!0,spacing:1,children:[(0,w.jsx)(i.ZP,{item:!0,xs:3,children:(0,w.jsxs)(v.Z,{fullWidth:!0,children:[(0,w.jsx)(f.Z,{id:"param_label"+e.index,size:"small",children:t("mintNFT.paramType")}),(0,w.jsxs)(b.Z,{id:"param_select_"+e.index,name:"S_"+e.index,label:t("mintNFT.paramType"),labelId:"param_label"+e.index,size:"small",value:e.type,onChange:t=>{e.paramSelectChange(t)},children:[(0,w.jsx)(F.Z,{value:"address",children:"address"}),(0,w.jsx)(F.Z,{value:"uint8",children:"uint8"}),(0,w.jsx)(F.Z,{value:"uint256",children:"uint256"}),(0,w.jsx)(F.Z,{value:"bool",children:"bool"}),(0,w.jsx)(F.Z,{value:"string",children:"string"}),(0,w.jsx)(F.Z,{value:"merkleSign",children:"merkleSign"})]})]})}),(0,w.jsx)(i.ZP,{item:!0,xs:6,children:(0,w.jsx)(c.Z,{fullWidth:!0,id:"T_"+e.index,label:t("mintNFT.paramValue"),variant:"outlined",size:"small",value:a,onChange:t=>{e.paramChange(t)}})}),(0,w.jsx)(i.ZP,{item:!0,xs:1,children:(0,w.jsx)(o.Z,{id:e.index,variant:"outlined",startIcon:(0,w.jsx)(k.Z,{}),onClick:e.deleteParam,children:t("mintNFT.delParam")})})]})}var T=a(62446),S=a(25091),N=a(97319),I=a(71247),G=a(33497),L=a(32703),_=a(12274),O=a(83838),V=a(71709);const z=a(15372);let M=!1,W={},D={addrStr:"",pkStr:"",pkArr:[],addrArr:[]};var E=function(){const e=(0,r.v9)((e=>e.blockchain)),{t:t}=(0,s.$)(),a=(0,A.Z)(),{CHAIN:v,CHAINID:f}=S.IB[N.Z.get("networkNow")],[b,F]=(0,n.useState)(S.IB[N.Z.get("networkNow")].RPC),[k,E]=(0,n.useState)(new z(new z.providers.HttpProvider(b))),[H,U]=(0,n.useState)("mint"),[B,K]=(0,n.useState)([{type:"uint256",value:1}]),[R,q]=(0,n.useState)(!1),[$,Q]=(0,n.useState)({type:"",msg:null}),[J,X]=(0,n.useState)(!1),[Y,ee]=(0,n.useState)({type:"",msg:null}),[te,ae]=(0,n.useState)(!1),[ne,se]=(0,n.useState)({addrStr:"",pkStr:"",pkArr:[],addrArr:[]}),[re,ie]=(0,n.useState)({isOpen:!1,msg:"",nonce:""}),[le,de]=(0,n.useState)({contractAddress:"",maxPriorityFeePerGas:1,maxFeePerGas:20,ethValue:0}),ce=e=>{oe(e.target.id,e.target.value)},oe=(e,t)=>{const a={[e]:t};de((e=>({...e,...a})))},me=e=>{let t=e.target.name.slice(2),a=e.target.value;B[t].type=a,K(B),je()},ue=e=>{let t=e.target.id.slice(2),a=e.target.value;B[t].value=a,K(B),je()},he=()=>{let t=setInterval((async()=>{const a=await async function(){const{_estimateGas:t}=(0,I.n)(k,v),a="0xF6Cbda3862e9E95e42aFf439936f3FD5556cF4Be",n=await pe(a).then((e=>e));let s=await k.eth.getTransactionCount(a);return await t({from:a,to:le.contractAddress,value:le.ethValue||0,gasLimit:e.gasLimit,maxPriorityFeePerGas:le.maxPriorityFeePerGas,maxFeePerGas:le.maxFeePerGas,data:n,nonce:s})}();if(a.error)return clearInterval(t),ie({isOpen:!0,msg:a.error,nonce:parseInt(1e4*Math.random())}),void ae(!1);"number"==typeof a&&a<S.Lw&&(clearInterval(t),ne.pkArr.forEach(((t,a)=>{!async function(t,a){const{_sendTx:n}=(0,I.n)(k,v),s=D.addrArr[a],r=await pe(s).then((e=>e));let i=await k.eth.getTransactionCount(s);W={...W,[s]:i};const l=await n({from:s,to:le.contractAddress,value:le.ethValue||0,gasLimit:e.gasLimit,maxPriorityFeePerGas:le.maxPriorityFeePerGas,maxFeePerGas:le.maxFeePerGas,data:r,nonce:i,pk:t});let d="";d=Object.keys(l).includes("error")?"\u274c"+l.error:"\u2714\ufe0f"+l.transactionHash;xe({index:a,timesChange:0,status:d})}(t,a),xe({index:a,timesChange:1,status:"pending..."}),ne.pkArr.length-1==a&&ae(!1)})))}),1e3)},xe=async e=>{let{index:t,timesChange:a,status:n}=e;try{ve((e=>{let s=[...e];for(let r=0;r<s.length;r++)r==t&&(s[r]={id:s[r].id,address:s[r].address,balance:s[r].balance,times:s[r].times+a,status:n});return s}))}catch(s){}ie({isOpen:!0,msg:n,nonce:parseInt(1e4*Math.random())})};async function pe(e){let t="",a=[],n=[];for(let s=0;s<B.length;s++){const r=B[s];let i,l;if("merkleSign"==r.type){if(i=await(0,_.t)(le.contractAddress.toLowerCase(),e),!i.sign)return void ie({isOpen:!0,msg:"Unable to get merkleSign",nonce:parseInt(1e4*Math.random())});l=i.sign}const d="merkleSign"==r.type?"bytes32[]":r.type,c="merkleSign"==r.type?l:r.value;t=""==t?t+d:t+","+d,a.push(d),n.push(c)}return k.eth.abi.encodeFunctionSignature(H+"("+t+")")+k.eth.abi.encodeParameters(a,n).slice(2)}const[ge,Pe]=(0,n.useState)([]),je=()=>{let e=[];B.forEach(((t,a)=>{e.push((0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(C,{index:a,type:B[a].type,value:B[a].value,paramSelectChange:me,paramChange:ue,deleteParam:Ze})},a))})),Pe(e)},Ze=e=>{B.splice(e.target.id,1),K(B),je()};(0,n.useEffect)((()=>{je()}),[]);const[ye,ve]=(0,n.useState)([{id:1,address:"",balance:"",times:"",status:"",action:""}]),fe=[{field:"id",hide:!0},{field:"address",headerName:t("mintNFT.address"),width:150},{field:"balance",headerName:t("mintNFT.amount"),width:80},{field:"times",headerName:t("mintNFT.requestTimes"),width:160},{field:"status",headerName:t("mintNFT.status"),width:400}],be=async e=>{let t=await Promise.all(e.map((async(e,t)=>{const a=D.addrArr[t],n=await k.eth.getBalance(a);return{id:t+1,address:a,balance:k.utils.fromWei(n,"ether"),times:0,status:"--"}})));ve(t)},[Fe,ke]=(0,n.useState)(new Date),[Ae,we]=(0,n.useState)(!1),[Ce,Te]=(0,n.useState)(0),[Se,Ne]=(0,n.useState)({}),Ie=(e,t)=>{Ne((a=>({...a,[e]:t})))},Ge=()=>{if(!Le())return ie({isOpen:!0,msg:"Invalid gasLimit",nonce:parseInt(1e4*Math.random())}),!1;const e=_e(le.contractAddress);if(Ie("contractAddress",!e),!e)return ie({isOpen:!0,msg:"Contract Address required",nonce:parseInt(1e4*Math.random())}),!1;const t=(a=le.ethValue,"NaN"!=parseFloat(a).toString());var a;if(Ie("ethValue",!t),!t)return ie({isOpen:!0,msg:"Eth Value not valid",nonce:parseInt(1e4*Math.random())}),!1;const n=Oe();return Ie("privateKey",!n),!!n||(ie({isOpen:!0,msg:"Private Key required",nonce:parseInt(1e4*Math.random())}),!1)},Le=()=>Number.isInteger(e.gasLimit)&&e.gasLimit>0,_e=e=>""!=e&&k.utils.isAddress(e),Oe=()=>ne.pkArr.length>0;return(0,w.jsx)(G.Z,{title:t("mintNFT.title"),secondary:(0,w.jsx)(i.ZP,{item:!0,xs:12,style:{textAlign:"right",verticalAlign:"middle",paddingTop:6,paddingBottom:6},children:(0,w.jsx)(l.Z,{"aria-label":"speedUp",onClick:async()=>{Ge()&&((0,V.PE)(W)?ie({isOpen:!0,msg:"No transactions need to be speed up",nonce:parseInt(1e4*Math.random())}):(ee({type:"_speedUp",msg:{}}),X(!0)))},sx:{color:a.palette.primary[200]},children:(0,w.jsx)(d.Z,{title:"Speed Up",children:(0,w.jsx)(P.Z,{})})})}),children:(0,w.jsxs)(i.ZP,{container:!0,spacing:2,children:[(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(i.ZP,{container:!0,spacing:2,children:(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(Z.Z,{action:{changeRPCAction:e=>{e.available&&E(new z(new z.providers.HttpProvider(e.rpc)))}}})})})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsxs)(i.ZP,{container:!0,spacing:2,children:[(0,w.jsx)(i.ZP,{item:!0,xs:9,sm:6,children:(0,w.jsx)(c.Z,{error:Se.contractAddress,fullWidth:!0,id:"contractAddress",label:t("mintNFT.contractAddress"),variant:"outlined",size:"small",value:le.contractAddress,onChange:ce})}),(0,w.jsx)(i.ZP,{item:!0,xs:1,children:(0,w.jsx)(o.Z,{variant:"text",onClick:()=>{oe("contractAddress","")},children:t("mintNFT.contractAddressClear")})})]})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsxs)(i.ZP,{container:!0,spacing:2,children:[(0,w.jsx)(i.ZP,{item:!0,xs:12,sm:2,children:(0,w.jsx)(T.Z,{})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,sm:3,children:(0,w.jsx)(c.Z,{fullWidth:!0,id:"maxPriorityFeePerGas",label:t("mintNFT.maxpriorityfeepergas"),variant:"outlined",size:"small",type:"number",value:le.maxPriorityFeePerGas,onChange:ce})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,sm:3,children:(0,w.jsx)(c.Z,{fullWidth:!0,id:"maxFeePerGas",label:t("mintNFT.maxFeePerGas"),variant:"outlined",size:"small",type:"number",value:le.maxFeePerGas,onChange:ce})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,sm:3,children:(0,w.jsx)(c.Z,{error:Se.ethValue,fullWidth:!0,id:"ethValue",label:t("mintNFT.ethAmout"),variant:"outlined",size:"small",type:"number",value:le.ethValue,onChange:ce})})]})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(i.ZP,{container:!0,spacing:2,children:(0,w.jsx)(i.ZP,{item:!0,xs:12,sm:3,children:(0,w.jsx)(c.Z,{id:"mint_method",label:t("mintNFT.mintMethod"),variant:"outlined",size:"small",value:H,onChange:e=>{U(e.target.value)}})})})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(i.ZP,{container:!0,spacing:2,children:(0,w.jsxs)(i.ZP,{item:!0,xs:12,children:[t("mintNFT.method"),(0,w.jsx)(o.Z,{variant:"outlined",onClick:()=>{B.push({type:"",value:""}),K(B),je()},children:t("mintNFT.addParam")})]})})}),ge,(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(y.Z,{canImportFromVbWallet:!0,setPk:e=>{se(e),D=e,be(e.pkArr)},provider:k,chain:v,title:t("mintNFT.importPrivateKeyTitle"),error:Se.privateKey,storageKey:"mintPk"})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(i.ZP,{container:!0,spacing:2,children:(0,w.jsxs)(i.ZP,{item:!0,xs:12,children:[t("mintNFT.openTimer"),(0,w.jsx)(m.Z,{checked:Ae,onChange:e=>{we(e.target.checked),M=e.target.checked}})]})})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,sx:{fontsize:16,display:Ae?"flex":"none",mt:1},children:(0,w.jsxs)(i.ZP,{container:!0,spacing:2,sx:{justifyContent:"flex-start",alignItems:"center",border:"solid 1px",borderColor:a.palette.grey[500],borderRadius:2,pb:"16px",ml:0,mr:0},children:[(0,w.jsxs)(i.ZP,{item:!0,sx:{minWidth:120,display:"flex"},children:[t("mintNFT.leftTime"),(0,w.jsx)("span",{style:{color:a.palette.secondary.main,paddingLeft:5},children:Ce})]}),(0,w.jsx)(i.ZP,{item:!0,children:(0,w.jsx)(x._,{dateAdapter:h.H,children:(0,w.jsx)(u.Z,{spacing:3,children:(0,w.jsx)(p.x,{size:"small",hideTabs:!0,value:Fe,onChange:e=>{ke(e)},minDate:new Date("2022-05-1"),renderInput:e=>(0,w.jsx)(c.Z,{...e})})})})})]})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(i.ZP,{container:!0,spacing:2,children:(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(L.Z,{onClick:async()=>{Ge()&&(()=>{const t={contractAddress:le.contractAddress,maxPriorityFeePerGas:le.maxPriorityFeePerGas,maxFeePerGas:le.maxFeePerGas,addressess:D.addrArr,ethValue:le.ethValue,gasLimit:e.gasLimit,mintMethod:H};Q({type:"_mintNFT",msg:t}),q(!0)})()},loading:te,variant:"contained",children:(0,w.jsx)("span",{children:t("mintNFT.execute")})})})})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,style:{height:300,width:"100%"},children:(0,w.jsx)(g._,{rows:ye,columns:fe})}),$.msg&&(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(O.U,{isOpen:R,msg:$.msg,okAction:async()=>{if(Ge())if(ae(!0),M){let e=setInterval((()=>{let t=(new Date(Fe).getTime()-Date.now())/1e3;t=t>0?t:0,Te(t),0!=M?0==t&&(clearInterval(e),he()):clearInterval(e)}),100)}else he()},closeDialog:()=>{q(!1)},type:$.type})}),Y.msg&&(0,w.jsx)(i.ZP,{item:!0,xs:12,children:(0,w.jsx)(O.U,{isOpen:J,msg:Y.msg,okAction:async()=>{ae(!0),ne.pkArr.forEach(((t,a)=>{!async function(t,a){const{_sendTx:n}=(0,I.n)(k,v),s=D.addrArr[a],r=await pe(s).then((e=>e));let i=W[s];W={...W,[s]:i};const l=await n({from:s,to:le.contractAddress,value:le.ethValue||0,gasLimit:e.gasLimit,maxPriorityFeePerGas:le.maxPriorityFeePerGas,maxFeePerGas:le.maxFeePerGas,data:r,nonce:i,pk:t});let d="";if(Object.keys(l).includes("error")){d="\xd7 "+("nonce too low"==l.error?"Last transaction has ok":"response.error")}else d="\u2713 "+l.transactionHash;xe({index:a,timesChange:0,status:d})}(t,a),xe({index:a,timesChange:1,status:"pending..."}),ne.pkArr.length-1==a&&ae(!1)}))},closeDialog:()=>{X(!1)},type:Y.type})}),(0,w.jsx)(i.ZP,{item:!0,xs:12,style:{display:re.isOpen?" ":"none"},children:(0,w.jsx)(j.Z,{msg:re.msg,nonce:re.nonce})},re.msg)]})})}},12274:function(e,t,a){a.d(t,{t:function(){return r},g:function(){return n}});const n={"0x954055d4483cfde798631b19611ec8cba920bfb7":{name:"Test",twitter:"",url:"http://localhost:3001/sign",params:["address"],method:"get"}},s=a(31881).default,r=async(e,t)=>{if("0x954055d4483cfde798631b19611ec8cba920bfb7"===e){return await i(e,t)}},i=async(e,t)=>{const a=n[e].url;return await s.get(a,{params:{address:t}}).then((function(e){return{treeRoot:e.data.result.root?e.data.result.root:"",sign:e.data.result.s?e.data.result.s:[]}})).catch((function(e){return{treeRoot:"",sign:[]}}))}}}]);